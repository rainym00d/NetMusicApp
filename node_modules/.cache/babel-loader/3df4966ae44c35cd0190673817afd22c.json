{"remainingRequest":"/Users/lsn/GitSpace/musicapp/node_modules/babel-loader/lib/index.js!/Users/lsn/GitSpace/musicapp/node_modules/vue-loader-v16/dist/templateLoader.js??ref--6!/Users/lsn/GitSpace/musicapp/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lsn/GitSpace/musicapp/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/lsn/GitSpace/musicapp/src/components/HomeSwiper.vue?vue&type=template&id=796f4ce7&scoped=true","dependencies":[{"path":"/Users/lsn/GitSpace/musicapp/src/components/HomeSwiper.vue","mtime":1635504177847},{"path":"/Users/lsn/GitSpace/musicapp/babel.config.js","mtime":1635323562046},{"path":"/Users/lsn/GitSpace/musicapp/node_modules/cache-loader/dist/cjs.js","mtime":1635338185367},{"path":"/Users/lsn/GitSpace/musicapp/node_modules/babel-loader/lib/index.js","mtime":1635338186090},{"path":"/Users/lsn/GitSpace/musicapp/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1635338186544},{"path":"/Users/lsn/GitSpace/musicapp/node_modules/cache-loader/dist/cjs.js","mtime":1635338185367},{"path":"/Users/lsn/GitSpace/musicapp/node_modules/vue-loader-v16/dist/index.js","mtime":1635338186082}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgcmVuZGVyTGlzdCBhcyBfcmVuZGVyTGlzdCwgRnJhZ21lbnQgYXMgX0ZyYWdtZW50LCBvcGVuQmxvY2sgYXMgX29wZW5CbG9jaywgY3JlYXRlRWxlbWVudEJsb2NrIGFzIF9jcmVhdGVFbGVtZW50QmxvY2ssIGNyZWF0ZUVsZW1lbnRWTm9kZSBhcyBfY3JlYXRlRWxlbWVudFZOb2RlLCBub3JtYWxpemVDbGFzcyBhcyBfbm9ybWFsaXplQ2xhc3MsIHB1c2hTY29wZUlkIGFzIF9wdXNoU2NvcGVJZCwgcG9wU2NvcGVJZCBhcyBfcG9wU2NvcGVJZCB9IGZyb20gInZ1ZSI7Cgp2YXIgX3dpdGhTY29wZUlkID0gZnVuY3Rpb24gX3dpdGhTY29wZUlkKG4pIHsKICByZXR1cm4gX3B1c2hTY29wZUlkKCJkYXRhLXYtNzk2ZjRjZTciKSwgbiA9IG4oKSwgX3BvcFNjb3BlSWQoKSwgbjsKfTsKCnZhciBfaG9pc3RlZF8xID0gewogICJjbGFzcyI6ICJzd2lwZXIiCn07CnZhciBfaG9pc3RlZF8yID0gWyJzcmMiXTsKdmFyIF9ob2lzdGVkXzMgPSB7CiAgImNsYXNzIjogImNpcmNsZS1saXN0Igp9Owp2YXIgX2hvaXN0ZWRfNCA9IFsib25DbGljayJdOwpleHBvcnQgZnVuY3Rpb24gcmVuZGVyKF9jdHgsIF9jYWNoZSwgJHByb3BzLCAkc2V0dXAsICRkYXRhLCAkb3B0aW9ucykgewogIHJldHVybiBfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soImRpdiIsIF9ob2lzdGVkXzEsIFtfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCB7CiAgICAiY2xhc3MiOiAic3dpcGVyLXNsaWRlIiwKICAgIHJlZjogInN3aXBlclNsaWRlIiwKICAgIG9uVG91Y2hzdGFydDogX2NhY2hlWzBdIHx8IChfY2FjaGVbMF0gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAkb3B0aW9ucy5oYW5kbGVTdGFydCAmJiAkb3B0aW9ucy5oYW5kbGVTdGFydC5hcHBseSgkb3B0aW9ucywgYXJndW1lbnRzKTsKICAgIH0pLAogICAgb25Ub3VjaG1vdmU6IF9jYWNoZVsxXSB8fCAoX2NhY2hlWzFdID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gJG9wdGlvbnMuaGFuZGxlTW92ZSAmJiAkb3B0aW9ucy5oYW5kbGVNb3ZlLmFwcGx5KCRvcHRpb25zLCBhcmd1bWVudHMpOwogICAgfSksCiAgICBvblRvdWNoZW5kOiBfY2FjaGVbMl0gfHwgKF9jYWNoZVsyXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICRvcHRpb25zLmhhbmRsZUVuZCAmJiAkb3B0aW9ucy5oYW5kbGVFbmQuYXBwbHkoJG9wdGlvbnMsIGFyZ3VtZW50cyk7CiAgICB9KQogIH0sIFsoX29wZW5CbG9jayh0cnVlKSwgX2NyZWF0ZUVsZW1lbnRCbG9jayhfRnJhZ21lbnQsIG51bGwsIF9yZW5kZXJMaXN0KCRkYXRhLmJhbm5lckxpc3QsIGZ1bmN0aW9uIChpdGVtLCBpKSB7CiAgICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlRWxlbWVudEJsb2NrKCJpbWciLCB7CiAgICAgIGtleTogaSwKICAgICAgc3JjOiBpdGVtLnBpYywKICAgICAgYWx0OiAi5Zu+54mH5LiN6KeB5LqGIgogICAgfSwgbnVsbCwgOAogICAgLyogUFJPUFMgKi8KICAgICwgX2hvaXN0ZWRfMik7CiAgfSksIDEyOAogIC8qIEtFWUVEX0ZSQUdNRU5UICovCiAgKSldLCA1NDQKICAvKiBIWURSQVRFX0VWRU5UUywgTkVFRF9QQVRDSCAqLwogICksIF9jcmVhdGVFbGVtZW50Vk5vZGUoInVsIiwgX2hvaXN0ZWRfMywgWyhfb3BlbkJsb2NrKHRydWUpLCBfY3JlYXRlRWxlbWVudEJsb2NrKF9GcmFnbWVudCwgbnVsbCwgX3JlbmRlckxpc3QoJGRhdGEuaW5kZXhMaXN0LCBmdW5jdGlvbiAoaW5kZXgpIHsKICAgIHJldHVybiBfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soImxpIiwgewogICAgICAiY2xhc3MiOiBfbm9ybWFsaXplQ2xhc3MoWyJjaXJjbGUiLCB7CiAgICAgICAgYWN0aXZlOiBpbmRleCA9PT0gJGRhdGEuY3VycmVudEluZGV4CiAgICAgIH1dKSwKICAgICAga2V5OiBpbmRleCwKICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygkZXZlbnQpIHsKICAgICAgICByZXR1cm4gJG9wdGlvbnMuY2xpY2tUb0ltYWdlKGluZGV4KTsKICAgICAgfQogICAgfSwgbnVsbCwgMTAKICAgIC8qIENMQVNTLCBQUk9QUyAqLwogICAgLCBfaG9pc3RlZF80KTsKICB9KSwgMTI4CiAgLyogS0VZRURfRlJBR01FTlQgKi8KICApKV0pXSk7Cn0="},{"version":3,"sources":["/Users/lsn/GitSpace/musicapp/src/components/HomeSwiper.vue"],"names":[],"mappings":";;;;;;;AACO,WAAM;;;;AAeL,WAAM;;;;uBAfZ,mBAAA,CAwBM,KAxBN,EAAA,UAAA,EAwBM,CAvBJ,mBAAA,CAaM,KAbN,EAaM;AAZJ,aAAM,cAYF;AAXJ,IAAA,GAAG,EAAC,aAWA;AAVH,IAAA,YAAU,EAAA,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA;AAAA,aAAE,QAAA,CAAA,WAAA,IAAA,QAAA,CAAA,WAAA,OAAA,QAAA,YAAF;AAAA,KAAA,CAUP;AATH,IAAA,WAAS,EAAA,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA;AAAA,aAAE,QAAA,CAAA,UAAA,IAAA,QAAA,CAAA,UAAA,OAAA,QAAA,YAAF;AAAA,KAAA,CASN;AARH,IAAA,UAAQ,EAAA,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA;AAAA,aAAE,QAAA,CAAA,SAAA,IAAA,QAAA,CAAA,SAAA,OAAA,QAAA,YAAF;AAAA,KAAA;AAQL,GAbN,E,oBAOE,mBAAA,CAKE,SALF,EAKE,IALF,EAKE,WAAA,CAJoB,KAAA,CAAA,UAIpB,EAJ8B,UAAtB,IAAsB,EAAhB,CAAgB,EAAf;yBADjB,mBAAA,CAKE,KALF,EAKE;AAHC,MAAA,GAAG,EAAE,CAGN;AAFC,MAAA,GAAG,EAAE,IAAI,CAAC,GAEX;AADA,MAAA,GAAG,EAAC;AACJ,KALF,E,IAAA,E;;AAAA,M,UAAA,C;GAKE,CALF,E;;AAAA,G,EAPF,E;;AAAA,GAuBI,EATJ,mBAAA,CAQK,IARL,EAAA,UAAA,EAQK,E,kBAPH,mBAAA,CAMM,SANN,EAMM,IANN,EAMM,WAAA,CAJY,KAAA,CAAA,SAIZ,EAJqB,UAAlB,KAAkB,EAAb;yBAFd,mBAAA,CAMM,IANN,EAMM;AALJ,eAAK,eAAA,CAAA,CAAC,QAAD,EAAS;AAAA,QAAA,MAAA,EAII,KAAK,KAAK,KAAA,CAAA;AAJd,OAAT,CAAA,CAKD;AAHH,MAAA,GAAG,EAAE,KAGF;AAFH,MAAA,OAAK,EAAA,iBAAA,MAAA;AAAA,eAAE,QAAA,CAAA,YAAA,CAAa,KAAb,CAAF;AAAA;AAEF,KANN,E,IAAA,E;;AAAA,M,UAAA,C;GAMM,CANN,E;;AAAA,GAOG,EARL,CASI,CAxBN,C","sourcesContent":["<template>\n  <div class=\"swiper\">\n    <div\n      class=\"swiper-slide\"\n      ref=\"swiperSlide\"\n      @touchstart=\"handleStart\"\n      @touchmove=\"handleMove\"\n      @touchend=\"handleEnd\"\n    >\n      <img\n        v-for=\"(item, i) in bannerList\"\n        :key=\"i\"\n        :src=\"item.pic\"\n        alt=\"图片不见了\"\n      />\n    </div>\n    <ul class=\"circle-list\">\n      <li\n        class=\"circle\"\n        v-for=\"index in indexList\"\n        :key=\"index\"\n        @click=\"clickToImage(index)\"\n        :class=\"{ active: index === currentIndex }\"\n      ></li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport { getBanner } from \"@/api/index\";\n\nexport default {\n  data() {\n    return {\n      //\n      // rem: 0,\n      imageWidth: 0,\n\n      // 与图片相关的变量\n      bannerList: [],\n      indexList: [],\n      currentIndex: 0,\n      // 与鼠标拖动相关的变量\n      // 1. 起始鼠标横坐标\n      // 2. 鼠标横坐标移动的距离\n      startX: 0,\n      distanceX: 0,\n      startLeft: 0,\n\n      // 与计时器相关的变量\n      // 1. 持续动作计时器ID\n      // 2. 间隔时间\n      // 3. 延时计时器ID\n      intervalId: 0,\n      intervalTime: 5000,\n      timeoutID: 0,\n      // 与锁相关的变量\n      // 1. 自动播放的锁，自动播放动画进行时只允许点击小圆点进行图片切换，不允许拖动\n      //\n      swiperLock: false,\n      touchLock: false,\n      moveLock: false,\n    };\n  },\n  components: {},\n\n  async mounted() {\n    let res = await getBanner(1);\n    this.bannerList = res.data.banners;\n    // console.log(this.bannerList);\n\n    this.indexList = this.bannerList.map((ele, i) => i);\n\n    this.bannerList.push(this.bannerList[0]);\n    this.bannerList.unshift(this.bannerList[this.indexList.length - 1]);\n\n    this.startAutoplay();\n\n    // this.rem = parseFloat(getComputedStyle(document.documentElement).fontSize);\n    this.imageWidth = parseFloat(\n      getComputedStyle(this.$refs.swiperSlide).width\n    );\n    // console.log(this.imageWidth);\n  },\n  beforeUnmounted() {\n    this.stopAutoplay();\n  },\n  methods: {\n    startAutoplay() {\n      this.intervalId = setInterval(this.toNextImage, this.intervalTime);\n      // this.intervalId = setInterval(this.toPreviousImage, this.intervalTime);\n    },\n    stopAutoplay() {\n      clearInterval(this.intervalId);\n      //\n      clearTimeout(this.timeoutID);\n      this.$refs.swiperSlide.style.transition = \"all 0.3s ease-in\";\n    },\n\n    handleStart(e) {\n      // console.log(e.targetTouches[0]);\n      if (e.targetTouches.length > 1 || this.swiperLock) {\n        this.touchLock = false;\n        return;\n      } else {\n        this.touchLock = true;\n      }\n\n      this.stopAutoplay();\n      this.startX = e.targetTouches[0].pageX;\n      this.startLeft = parseFloat(\n        getComputedStyle(this.$refs.swiperSlide).left\n      );\n      this.$refs.swiperSlide.style.transition = \"left 0.1s\";\n      // console.log(rem);\n    },\n    handleMove(e) {\n      if (!this.touchLock) {\n        return;\n      }\n      // console.log(e.targetTouches[0].screenX);\n      if (!this.moveLock) {\n        this.moveLock = true;\n        this.distanceX = e.targetTouches[0].pageX - this.startX;\n        this.$refs.swiperSlide.style.left =\n          this.startLeft + this.distanceX + \"px\";\n        setTimeout(() => {\n          this.moveLock = false;\n        }, 50);\n      }\n    },\n    handleEnd() {\n      if (!this.touchLock) {\n        return;\n      }\n      if (Math.abs(this.distanceX) * 3 < this.imageWidth) {\n        this.toImage(this.currentIndex);\n      } else if (this.distanceX < 0) {\n        this.toNextImage();\n      } else {\n        this.toPreviousImage();\n      }\n      this.startAutoplay();\n      // console.log(this.distanceX);\n    },\n\n    toImage(index) {\n      // 设置当前索引\n      this.currentIndex = index;\n      // 计算左偏移量，跟巨偏移量转换当前的轮播图\n      this.$refs.swiperSlide.style.left = -(index + 1) * 7.1 + \"rem\";\n    },\n    toNextImage() {\n      if (this.swiperLock) {\n        return;\n      }\n      // 设置自动播放的锁\n      this.swiperLock = true;\n      this.currentIndex++;\n      // 如果轮播图到了最后一张，为了体现出循环播放的效果，\n      // 于是转到事先存在最后一张后边的第一张图，等动画结束后再做切换\n      if (this.currentIndex === this.indexList.length) {\n        this.currentIndex = 0;\n        this.$refs.swiperSlide.style.left =\n          -(this.indexList.length + 1) * 7.1 + \"rem\";\n\n        this.timeoutID = setTimeout(() => {\n          this.$refs.swiperSlide.style.transition = \"none\";\n          this.$refs.swiperSlide.style.left = \"-7.1rem\";\n        }, 300);\n      } else {\n        this.$refs.swiperSlide.style.transition = \"all 0.3s ease-in\";\n        this.toImage(this.currentIndex);\n      }\n      // 动画效果结束后，解除自动播放的锁\n      setTimeout(() => {\n        this.swiperLock = false;\n      }, 300);\n    },\n    toPreviousImage() {\n      if (this.swiperLock) {\n        return;\n      }\n      // 设置自动播放的锁\n      this.swiperLock = true;\n      this.currentIndex--;\n      // 如果轮播图到了最后一张，为了体现出循环播放的效果，\n      // 于是转到事先存在最后一张后边的第一张图，等动画结束后再做切换\n      if (this.currentIndex === -1) {\n        this.currentIndex = this.indexList.length - 1;\n        this.$refs.swiperSlide.style.left = \"0rem\";\n\n        this.timeoutID = setTimeout(() => {\n          this.$refs.swiperSlide.style.transition = \"none\";\n          this.$refs.swiperSlide.style.left =\n            -this.indexList.length * 7.1 + \"rem\";\n        }, 300);\n      } else {\n        this.$refs.swiperSlide.style.transition = \"all 0.3s ease-in\";\n        this.toImage(this.currentIndex);\n      }\n      // 动画效果结束后，解除自动播放的锁\n      setTimeout(() => {\n        this.swiperLock = false;\n      }, 300);\n    },\n\n    clickToImage(index) {\n      this.stopAutoplay();\n      this.toImage(index);\n      this.startAutoplay();\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.swiper {\n  width: 7.1rem;\n  max-height: 3rem;\n  position: relative;\n  margin: 0 0.2rem;\n  overflow: hidden;\n\n  .swiper-slide {\n    display: flex;\n    width: 100%;\n    height: 100%;\n    position: relative;\n    left: -7.1rem;\n    transition: all 0.3s ease-in;\n\n    img {\n      width: 100%;\n      border-radius: 0.1rem;\n    }\n  }\n\n  .circle-list {\n    display: inline-flex;\n    flex-wrap: wrap;\n    position: absolute;\n    width: 4rem;\n    margin: 0 auto;\n    bottom: 0.1rem;\n    left: 0;\n    right: 0;\n    justify-content: space-around;\n    list-style-type: none;\n\n    .circle {\n      width: 0.12rem;\n      height: 0.12rem;\n      background-color: #ecf0f1;\n      border-radius: 50%;\n      cursor: pointer;\n    }\n\n    .active {\n      background-color: #e74c3c;\n    }\n  }\n}\n</style>"],"sourceRoot":""}]}