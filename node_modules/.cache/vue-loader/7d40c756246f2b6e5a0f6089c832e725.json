{"remainingRequest":"/Users/lsn/GitSpace/musicapp/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/lsn/GitSpace/musicapp/src/components/HomeSwiper.vue?vue&type=template&id=796f4ce7&scoped=true","dependencies":[{"path":"/Users/lsn/GitSpace/musicapp/src/components/HomeSwiper.vue","mtime":1635504177847},{"path":"/Users/lsn/GitSpace/musicapp/node_modules/cache-loader/dist/cjs.js","mtime":1635338185367},{"path":"/Users/lsn/GitSpace/musicapp/node_modules/babel-loader/lib/index.js","mtime":1635338186090},{"path":"/Users/lsn/GitSpace/musicapp/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1635338186544},{"path":"/Users/lsn/GitSpace/musicapp/node_modules/cache-loader/dist/cjs.js","mtime":1635338185367},{"path":"/Users/lsn/GitSpace/musicapp/node_modules/vue-loader-v16/dist/index.js","mtime":1635338186082}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgPGRpdiBjbGFzcz0ic3dpcGVyIj4KICAgIDxkaXYKICAgICAgY2xhc3M9InN3aXBlci1zbGlkZSIKICAgICAgcmVmPSJzd2lwZXJTbGlkZSIKICAgICAgQHRvdWNoc3RhcnQ9ImhhbmRsZVN0YXJ0IgogICAgICBAdG91Y2htb3ZlPSJoYW5kbGVNb3ZlIgogICAgICBAdG91Y2hlbmQ9ImhhbmRsZUVuZCIKICAgID4KICAgICAgPGltZwogICAgICAgIHYtZm9yPSIoaXRlbSwgaSkgaW4gYmFubmVyTGlzdCIKICAgICAgICA6a2V5PSJpIgogICAgICAgIDpzcmM9Iml0ZW0ucGljIgogICAgICAgIGFsdD0i5Zu+54mH5LiN6KeB5LqGIgogICAgICAvPgogICAgPC9kaXY+CiAgICA8dWwgY2xhc3M9ImNpcmNsZS1saXN0Ij4KICAgICAgPGxpCiAgICAgICAgY2xhc3M9ImNpcmNsZSIKICAgICAgICB2LWZvcj0iaW5kZXggaW4gaW5kZXhMaXN0IgogICAgICAgIDprZXk9ImluZGV4IgogICAgICAgIEBjbGljaz0iY2xpY2tUb0ltYWdlKGluZGV4KSIKICAgICAgICA6Y2xhc3M9InsgYWN0aXZlOiBpbmRleCA9PT0gY3VycmVudEluZGV4IH0iCiAgICAgID48L2xpPgogICAgPC91bD4KICA8L2Rpdj4K"},{"version":3,"sources":["/Users/lsn/GitSpace/musicapp/src/components/HomeSwiper.vue"],"names":[],"mappings":";EACE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,CAAC;MACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACxB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACtB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACtB;MACE,CAAC,CAAC,CAAC;QACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC9B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACZ,CAAC;IACH,CAAC,CAAC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACrB,CAAC,CAAC;QACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACzB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;MAC5C,CAAC,CAAC,CAAC,CAAC,CAAC;IACP,CAAC,CAAC,CAAC,CAAC;EACN,CAAC,CAAC,CAAC,CAAC,CAAC","file":"/Users/lsn/GitSpace/musicapp/src/components/HomeSwiper.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"swiper\">\n    <div\n      class=\"swiper-slide\"\n      ref=\"swiperSlide\"\n      @touchstart=\"handleStart\"\n      @touchmove=\"handleMove\"\n      @touchend=\"handleEnd\"\n    >\n      <img\n        v-for=\"(item, i) in bannerList\"\n        :key=\"i\"\n        :src=\"item.pic\"\n        alt=\"图片不见了\"\n      />\n    </div>\n    <ul class=\"circle-list\">\n      <li\n        class=\"circle\"\n        v-for=\"index in indexList\"\n        :key=\"index\"\n        @click=\"clickToImage(index)\"\n        :class=\"{ active: index === currentIndex }\"\n      ></li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport { getBanner } from \"@/api/index\";\n\nexport default {\n  data() {\n    return {\n      //\n      // rem: 0,\n      imageWidth: 0,\n\n      // 与图片相关的变量\n      bannerList: [],\n      indexList: [],\n      currentIndex: 0,\n      // 与鼠标拖动相关的变量\n      // 1. 起始鼠标横坐标\n      // 2. 鼠标横坐标移动的距离\n      startX: 0,\n      distanceX: 0,\n      startLeft: 0,\n\n      // 与计时器相关的变量\n      // 1. 持续动作计时器ID\n      // 2. 间隔时间\n      // 3. 延时计时器ID\n      intervalId: 0,\n      intervalTime: 5000,\n      timeoutID: 0,\n      // 与锁相关的变量\n      // 1. 自动播放的锁，自动播放动画进行时只允许点击小圆点进行图片切换，不允许拖动\n      //\n      swiperLock: false,\n      touchLock: false,\n      moveLock: false,\n    };\n  },\n  components: {},\n\n  async mounted() {\n    let res = await getBanner(1);\n    this.bannerList = res.data.banners;\n    // console.log(this.bannerList);\n\n    this.indexList = this.bannerList.map((ele, i) => i);\n\n    this.bannerList.push(this.bannerList[0]);\n    this.bannerList.unshift(this.bannerList[this.indexList.length - 1]);\n\n    this.startAutoplay();\n\n    // this.rem = parseFloat(getComputedStyle(document.documentElement).fontSize);\n    this.imageWidth = parseFloat(\n      getComputedStyle(this.$refs.swiperSlide).width\n    );\n    // console.log(this.imageWidth);\n  },\n  beforeUnmounted() {\n    this.stopAutoplay();\n  },\n  methods: {\n    startAutoplay() {\n      this.intervalId = setInterval(this.toNextImage, this.intervalTime);\n      // this.intervalId = setInterval(this.toPreviousImage, this.intervalTime);\n    },\n    stopAutoplay() {\n      clearInterval(this.intervalId);\n      //\n      clearTimeout(this.timeoutID);\n      this.$refs.swiperSlide.style.transition = \"all 0.3s ease-in\";\n    },\n\n    handleStart(e) {\n      // console.log(e.targetTouches[0]);\n      if (e.targetTouches.length > 1 || this.swiperLock) {\n        this.touchLock = false;\n        return;\n      } else {\n        this.touchLock = true;\n      }\n\n      this.stopAutoplay();\n      this.startX = e.targetTouches[0].pageX;\n      this.startLeft = parseFloat(\n        getComputedStyle(this.$refs.swiperSlide).left\n      );\n      this.$refs.swiperSlide.style.transition = \"left 0.1s\";\n      // console.log(rem);\n    },\n    handleMove(e) {\n      if (!this.touchLock) {\n        return;\n      }\n      // console.log(e.targetTouches[0].screenX);\n      if (!this.moveLock) {\n        this.moveLock = true;\n        this.distanceX = e.targetTouches[0].pageX - this.startX;\n        this.$refs.swiperSlide.style.left =\n          this.startLeft + this.distanceX + \"px\";\n        setTimeout(() => {\n          this.moveLock = false;\n        }, 50);\n      }\n    },\n    handleEnd() {\n      if (!this.touchLock) {\n        return;\n      }\n      if (Math.abs(this.distanceX) * 3 < this.imageWidth) {\n        this.toImage(this.currentIndex);\n      } else if (this.distanceX < 0) {\n        this.toNextImage();\n      } else {\n        this.toPreviousImage();\n      }\n      this.startAutoplay();\n      // console.log(this.distanceX);\n    },\n\n    toImage(index) {\n      // 设置当前索引\n      this.currentIndex = index;\n      // 计算左偏移量，跟巨偏移量转换当前的轮播图\n      this.$refs.swiperSlide.style.left = -(index + 1) * 7.1 + \"rem\";\n    },\n    toNextImage() {\n      if (this.swiperLock) {\n        return;\n      }\n      // 设置自动播放的锁\n      this.swiperLock = true;\n      this.currentIndex++;\n      // 如果轮播图到了最后一张，为了体现出循环播放的效果，\n      // 于是转到事先存在最后一张后边的第一张图，等动画结束后再做切换\n      if (this.currentIndex === this.indexList.length) {\n        this.currentIndex = 0;\n        this.$refs.swiperSlide.style.left =\n          -(this.indexList.length + 1) * 7.1 + \"rem\";\n\n        this.timeoutID = setTimeout(() => {\n          this.$refs.swiperSlide.style.transition = \"none\";\n          this.$refs.swiperSlide.style.left = \"-7.1rem\";\n        }, 300);\n      } else {\n        this.$refs.swiperSlide.style.transition = \"all 0.3s ease-in\";\n        this.toImage(this.currentIndex);\n      }\n      // 动画效果结束后，解除自动播放的锁\n      setTimeout(() => {\n        this.swiperLock = false;\n      }, 300);\n    },\n    toPreviousImage() {\n      if (this.swiperLock) {\n        return;\n      }\n      // 设置自动播放的锁\n      this.swiperLock = true;\n      this.currentIndex--;\n      // 如果轮播图到了最后一张，为了体现出循环播放的效果，\n      // 于是转到事先存在最后一张后边的第一张图，等动画结束后再做切换\n      if (this.currentIndex === -1) {\n        this.currentIndex = this.indexList.length - 1;\n        this.$refs.swiperSlide.style.left = \"0rem\";\n\n        this.timeoutID = setTimeout(() => {\n          this.$refs.swiperSlide.style.transition = \"none\";\n          this.$refs.swiperSlide.style.left =\n            -this.indexList.length * 7.1 + \"rem\";\n        }, 300);\n      } else {\n        this.$refs.swiperSlide.style.transition = \"all 0.3s ease-in\";\n        this.toImage(this.currentIndex);\n      }\n      // 动画效果结束后，解除自动播放的锁\n      setTimeout(() => {\n        this.swiperLock = false;\n      }, 300);\n    },\n\n    clickToImage(index) {\n      this.stopAutoplay();\n      this.toImage(index);\n      this.startAutoplay();\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.swiper {\n  width: 7.1rem;\n  max-height: 3rem;\n  position: relative;\n  margin: 0 0.2rem;\n  overflow: hidden;\n\n  .swiper-slide {\n    display: flex;\n    width: 100%;\n    height: 100%;\n    position: relative;\n    left: -7.1rem;\n    transition: all 0.3s ease-in;\n\n    img {\n      width: 100%;\n      border-radius: 0.1rem;\n    }\n  }\n\n  .circle-list {\n    display: inline-flex;\n    flex-wrap: wrap;\n    position: absolute;\n    width: 4rem;\n    margin: 0 auto;\n    bottom: 0.1rem;\n    left: 0;\n    right: 0;\n    justify-content: space-around;\n    list-style-type: none;\n\n    .circle {\n      width: 0.12rem;\n      height: 0.12rem;\n      background-color: #ecf0f1;\n      border-radius: 50%;\n      cursor: pointer;\n    }\n\n    .active {\n      background-color: #e74c3c;\n    }\n  }\n}\n</style>"]}]}