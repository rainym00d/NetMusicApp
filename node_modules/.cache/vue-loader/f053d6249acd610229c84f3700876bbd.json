{"remainingRequest":"/Users/lsn/code/musicapp/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/lsn/code/musicapp/src/components/HomeSwiper.vue?vue&type=style&index=0&id=796f4ce7&lang=less&scoped=true","dependencies":[{"path":"/Users/lsn/code/musicapp/src/components/HomeSwiper.vue","mtime":1635504177847},{"path":"/Users/lsn/code/musicapp/node_modules/css-loader/dist/cjs.js","mtime":1635338185822},{"path":"/Users/lsn/code/musicapp/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1635338186528},{"path":"/Users/lsn/code/musicapp/node_modules/postcss-loader/src/index.js","mtime":1635338186083},{"path":"/Users/lsn/code/musicapp/node_modules/less-loader/dist/cjs.js","mtime":1635338185930},{"path":"/Users/lsn/code/musicapp/node_modules/cache-loader/dist/cjs.js","mtime":1635338185367},{"path":"/Users/lsn/code/musicapp/node_modules/vue-loader-v16/dist/index.js","mtime":1635338186082}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5zd2lwZXIgewogIHdpZHRoOiA3LjFyZW07CiAgbWF4LWhlaWdodDogM3JlbTsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgbWFyZ2luOiAwIDAuMnJlbTsKICBvdmVyZmxvdzogaGlkZGVuOwoKICAuc3dpcGVyLXNsaWRlIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICB3aWR0aDogMTAwJTsKICAgIGhlaWdodDogMTAwJTsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIGxlZnQ6IC03LjFyZW07CiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlLWluOwoKICAgIGltZyB7CiAgICAgIHdpZHRoOiAxMDAlOwogICAgICBib3JkZXItcmFkaXVzOiAwLjFyZW07CiAgICB9CiAgfQoKICAuY2lyY2xlLWxpc3QgewogICAgZGlzcGxheTogaW5saW5lLWZsZXg7CiAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogNHJlbTsKICAgIG1hcmdpbjogMCBhdXRvOwogICAgYm90dG9tOiAwLjFyZW07CiAgICBsZWZ0OiAwOwogICAgcmlnaHQ6IDA7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDsKICAgIGxpc3Qtc3R5bGUtdHlwZTogbm9uZTsKCiAgICAuY2lyY2xlIHsKICAgICAgd2lkdGg6IDAuMTJyZW07CiAgICAgIGhlaWdodDogMC4xMnJlbTsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2VjZjBmMTsKICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICB9CgogICAgLmFjdGl2ZSB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNlNzRjM2M7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["/Users/lsn/code/musicapp/src/components/HomeSwiper.vue"],"names":[],"mappings":"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","file":"/Users/lsn/code/musicapp/src/components/HomeSwiper.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"swiper\">\n    <div\n      class=\"swiper-slide\"\n      ref=\"swiperSlide\"\n      @touchstart=\"handleStart\"\n      @touchmove=\"handleMove\"\n      @touchend=\"handleEnd\"\n    >\n      <img\n        v-for=\"(item, i) in bannerList\"\n        :key=\"i\"\n        :src=\"item.pic\"\n        alt=\"图片不见了\"\n      />\n    </div>\n    <ul class=\"circle-list\">\n      <li\n        class=\"circle\"\n        v-for=\"index in indexList\"\n        :key=\"index\"\n        @click=\"clickToImage(index)\"\n        :class=\"{ active: index === currentIndex }\"\n      ></li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport { getBanner } from \"@/api/index\";\n\nexport default {\n  data() {\n    return {\n      //\n      // rem: 0,\n      imageWidth: 0,\n\n      // 与图片相关的变量\n      bannerList: [],\n      indexList: [],\n      currentIndex: 0,\n      // 与鼠标拖动相关的变量\n      // 1. 起始鼠标横坐标\n      // 2. 鼠标横坐标移动的距离\n      startX: 0,\n      distanceX: 0,\n      startLeft: 0,\n\n      // 与计时器相关的变量\n      // 1. 持续动作计时器ID\n      // 2. 间隔时间\n      // 3. 延时计时器ID\n      intervalId: 0,\n      intervalTime: 5000,\n      timeoutID: 0,\n      // 与锁相关的变量\n      // 1. 自动播放的锁，自动播放动画进行时只允许点击小圆点进行图片切换，不允许拖动\n      //\n      swiperLock: false,\n      touchLock: false,\n      moveLock: false,\n    };\n  },\n  components: {},\n\n  async mounted() {\n    let res = await getBanner(1);\n    this.bannerList = res.data.banners;\n    // console.log(this.bannerList);\n\n    this.indexList = this.bannerList.map((ele, i) => i);\n\n    this.bannerList.push(this.bannerList[0]);\n    this.bannerList.unshift(this.bannerList[this.indexList.length - 1]);\n\n    this.startAutoplay();\n\n    // this.rem = parseFloat(getComputedStyle(document.documentElement).fontSize);\n    this.imageWidth = parseFloat(\n      getComputedStyle(this.$refs.swiperSlide).width\n    );\n    // console.log(this.imageWidth);\n  },\n  beforeUnmounted() {\n    this.stopAutoplay();\n  },\n  methods: {\n    startAutoplay() {\n      this.intervalId = setInterval(this.toNextImage, this.intervalTime);\n      // this.intervalId = setInterval(this.toPreviousImage, this.intervalTime);\n    },\n    stopAutoplay() {\n      clearInterval(this.intervalId);\n      //\n      clearTimeout(this.timeoutID);\n      this.$refs.swiperSlide.style.transition = \"all 0.3s ease-in\";\n    },\n\n    handleStart(e) {\n      // console.log(e.targetTouches[0]);\n      if (e.targetTouches.length > 1 || this.swiperLock) {\n        this.touchLock = false;\n        return;\n      } else {\n        this.touchLock = true;\n      }\n\n      this.stopAutoplay();\n      this.startX = e.targetTouches[0].pageX;\n      this.startLeft = parseFloat(\n        getComputedStyle(this.$refs.swiperSlide).left\n      );\n      this.$refs.swiperSlide.style.transition = \"left 0.1s\";\n      // console.log(rem);\n    },\n    handleMove(e) {\n      if (!this.touchLock) {\n        return;\n      }\n      // console.log(e.targetTouches[0].screenX);\n      if (!this.moveLock) {\n        this.moveLock = true;\n        this.distanceX = e.targetTouches[0].pageX - this.startX;\n        this.$refs.swiperSlide.style.left =\n          this.startLeft + this.distanceX + \"px\";\n        setTimeout(() => {\n          this.moveLock = false;\n        }, 50);\n      }\n    },\n    handleEnd() {\n      if (!this.touchLock) {\n        return;\n      }\n      if (Math.abs(this.distanceX) * 3 < this.imageWidth) {\n        this.toImage(this.currentIndex);\n      } else if (this.distanceX < 0) {\n        this.toNextImage();\n      } else {\n        this.toPreviousImage();\n      }\n      this.startAutoplay();\n      // console.log(this.distanceX);\n    },\n\n    toImage(index) {\n      // 设置当前索引\n      this.currentIndex = index;\n      // 计算左偏移量，跟巨偏移量转换当前的轮播图\n      this.$refs.swiperSlide.style.left = -(index + 1) * 7.1 + \"rem\";\n    },\n    toNextImage() {\n      if (this.swiperLock) {\n        return;\n      }\n      // 设置自动播放的锁\n      this.swiperLock = true;\n      this.currentIndex++;\n      // 如果轮播图到了最后一张，为了体现出循环播放的效果，\n      // 于是转到事先存在最后一张后边的第一张图，等动画结束后再做切换\n      if (this.currentIndex === this.indexList.length) {\n        this.currentIndex = 0;\n        this.$refs.swiperSlide.style.left =\n          -(this.indexList.length + 1) * 7.1 + \"rem\";\n\n        this.timeoutID = setTimeout(() => {\n          this.$refs.swiperSlide.style.transition = \"none\";\n          this.$refs.swiperSlide.style.left = \"-7.1rem\";\n        }, 300);\n      } else {\n        this.$refs.swiperSlide.style.transition = \"all 0.3s ease-in\";\n        this.toImage(this.currentIndex);\n      }\n      // 动画效果结束后，解除自动播放的锁\n      setTimeout(() => {\n        this.swiperLock = false;\n      }, 300);\n    },\n    toPreviousImage() {\n      if (this.swiperLock) {\n        return;\n      }\n      // 设置自动播放的锁\n      this.swiperLock = true;\n      this.currentIndex--;\n      // 如果轮播图到了最后一张，为了体现出循环播放的效果，\n      // 于是转到事先存在最后一张后边的第一张图，等动画结束后再做切换\n      if (this.currentIndex === -1) {\n        this.currentIndex = this.indexList.length - 1;\n        this.$refs.swiperSlide.style.left = \"0rem\";\n\n        this.timeoutID = setTimeout(() => {\n          this.$refs.swiperSlide.style.transition = \"none\";\n          this.$refs.swiperSlide.style.left =\n            -this.indexList.length * 7.1 + \"rem\";\n        }, 300);\n      } else {\n        this.$refs.swiperSlide.style.transition = \"all 0.3s ease-in\";\n        this.toImage(this.currentIndex);\n      }\n      // 动画效果结束后，解除自动播放的锁\n      setTimeout(() => {\n        this.swiperLock = false;\n      }, 300);\n    },\n\n    clickToImage(index) {\n      this.stopAutoplay();\n      this.toImage(index);\n      this.startAutoplay();\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.swiper {\n  width: 7.1rem;\n  max-height: 3rem;\n  position: relative;\n  margin: 0 0.2rem;\n  overflow: hidden;\n\n  .swiper-slide {\n    display: flex;\n    width: 100%;\n    height: 100%;\n    position: relative;\n    left: -7.1rem;\n    transition: all 0.3s ease-in;\n\n    img {\n      width: 100%;\n      border-radius: 0.1rem;\n    }\n  }\n\n  .circle-list {\n    display: inline-flex;\n    flex-wrap: wrap;\n    position: absolute;\n    width: 4rem;\n    margin: 0 auto;\n    bottom: 0.1rem;\n    left: 0;\n    right: 0;\n    justify-content: space-around;\n    list-style-type: none;\n\n    .circle {\n      width: 0.12rem;\n      height: 0.12rem;\n      background-color: #ecf0f1;\n      border-radius: 50%;\n      cursor: pointer;\n    }\n\n    .active {\n      background-color: #e74c3c;\n    }\n  }\n}\n</style>"]}]}